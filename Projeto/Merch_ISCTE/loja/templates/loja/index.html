<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>
        {% block title %}
        Merch@ISCTE Main Page
        {% endblock %}
    </title>
    <!-- Css -->
    {% load static %}
    <link href="{% static 'loja/css/style.css' %}" rel="stylesheet" type="text/css">
    <!-- Header -->
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <!-- Footer -->


    <script>
        // Prevent dropdown menu from closing when click inside the form
        $(document).on("click", ".navbar-right .dropdown-menu", function (e) {
            e.stopPropagation();
        });
    </script>
</head>
<body>

{% block headerblock %}

<header class="section-header">

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="{% url 'loja:index' %}">Merch<b>@ISCTE</b></a>
        <button class="navbar-toggler" data-target="#navbarCollapse" data-toggle="collapse" type="button">
            <span class="navbar-toggler-icon"></span>
        </button>
        <!-- Collection of nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse justify-content-start" id="navbarCollapse">
            <div class="navbar-nav">
                <a class="nav-item nav-link" href="#sobre">Sobre</a>
                <div class="nav-item dropdown">
                    <a class="nav-item nav-link dropdown-toggle" data-toggle="dropdown" href="#">Services</a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="#">Web Design</a>
                    </div>
                </div>
                <a class="nav-item nav-link" href="#">Blog</a>
            </div>
            <form class="navbar-form form-inline">
                <div class="input-group search-box">
                    <input class="form-control" id="search" placeholder="Search here..." type="text">
                    <div class="input-group-append">
                        <span class="input-group-text"><i class="material-icons">&#xE8B6;</i></span>
                    </div>
                </div>
            </form>
            <div class="navbar-nav action-buttons ml-auto">
                <a class="nav-item nav-link active" href="{% url 'loja:carrinho' %}">Carrinho</a>

                {% if not request.user.is_authenticated %}
                <a class="nav-item nav-link dropdown-toggle mr-3" data-toggle="dropdown" href="#">Login</a>
                <div class="dropdown-menu login-form">
                    <form action="{% url 'loja:loginview' %}" method="post">
                        {% csrf_token %}
                        <div class="form-group">
                            <label>Username</label>
                            <input class="form-control" id="username" name="username" required="required" type="text">
                        </div>
                        <div class="form-group">
                            <div class="clearfix">
                                <label>Password</label>
                                <a class="float-right text-muted" href="#"><small>Forgot?</small></a>
                            </div>
                            <input class="form-control" id="pass" name="pass" required="required" type="password">
                        </div>
                        <input class="btn btn-primary btn-block" type="submit" value="Login">
                    </form>
                </div>
                <a class="btn btn-primary" href="{% url 'loja:registaruser' %}">Registar</a>
                {% else %}
                <a class="nav-item nav-link active" href="{% url 'loja:perfil' %}">Perfil</a>
                <a class="nav-item nav-link dropdown-toggle mr-3" href="{% url 'loja:logoutview' %}">Logout</a>
                {% endif %}

            </div>
        </div>
    </nav>
</header>

{% if request.user.is_authenticated %}
{% if request.user.is_superuser %}
<h2> Olá admin </h2>
{% else %}
<h2> Olá {{ request.user.username}} </h2>
{% endif %}
{% else %}
{% endif %}

{% endblock %}

{% block blocobody %}

{% if request.user.is_superuser %}

<div class="navbar-nav action-buttons ml-auto">
    <a class="nav-item nav-link dropdown-toggle mr-3" data-toggle="dropdown" enctype="multipart/form-data" href="#">Criar Categoria</a>
    <div class="dropdown-menu categoria-form">
        <form action="{% url 'loja:nova_categoria' %}" method="post">
            {% csrf_token %}
            <div class="form-group">
                <label>Categoria</label>
                <input class="form-control" id="categoria_nome" name="categoria_nome" required="required"
                       type="text">
                <label>Imagem</label>
                <input class="form-control" id="categoria_file" name="categoria_file" type="file">
            </div>
            <input class="btn btn-primary btn-block" type="submit" value="Criar">
        </form>
    </div>
</div>

{% if uploaded_file_url %}
<p>File uploaded at: <a href="{{ uploaded_file_url }}">{{ uploaded_file_url }}</a></p>
{% endif %}

<div class="navbar-nav action-buttons ml-auto">
    <a class="nav-item nav-link dropdown-toggle mr-3" data-toggle="dropdown" href="#">Criar Produto</a>
    <div class="dropdown-menu categoria-form">
        <form action="{% url 'loja:novo_produto' %}" method="post">
            {% csrf_token %}
            <div class="form-group">
                <label>Nome</label>
                <input class="form-control" id="produto_nome" name="produto_nome" required="required" type="text">
                <label>Descrição</label>
                <input class="form-control" id="produto_texto" name="produto_texto" type="text">
                <label>Preço</label>
                <input class="form-control" id="preco_data" name="preco_data" required="required" type="number" min="0.01" step="0.01">
                <label for="categoria_select">Categoria:</label>
                <select id="categoria_select" name="categoria_select">
                    {% if lista_categoria %}
                    {% for categoria in lista_categoria %}
                    <option value="{{ categoria.categoria_nome }}">{{ categoria.categoria_nome }}</option>
                    {% endfor %}
                    {% endif %}
                </select>
                <br>
                <label>Imagem</label>
                <input class="form-control" id="produto_file" name="file" type="file">
            </div>
            <input class="btn btn-primary btn-block" type="submit" value="Criar">
        </form>
    </div>
</div>

{% endif %}

{% if lista_categoria %}
<ul class="common-list">
    {% for categoria in lista_categoria %}
    <li class="common-list-item">
        <a href="{% url 'loja:detalhe_categoria' categoria.id %}">
            <img max-width="30px" src="{{ categoria.foto }}">
        </a>
        <h4>{{ categoria.categoria_nome }}</h4>
    </li>

    {% endfor %}
</ul>
{% else %}
<p>Nao ha categorias disponíveis.</p>
{% endif %}


{% endblock %}


{% block lista-main %}

<a class="btn btn-primary" href="#">X</a>

{% endblock %}

{% block footer %}


{% endblock %}

</body>
</html>